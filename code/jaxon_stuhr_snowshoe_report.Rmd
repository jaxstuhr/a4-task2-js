---
title: "Bonanza Creek Snowshoe Hairs Mini Report"
author: "Jaxon Stuhr"
date: "11/5/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(janitor)
library(here)
library(kableExtra)
library(lubridate)
library(effsize)
```

```{r}
# read in data
bonanza_hares_raw = read_csv(here("data", "bonanza_hares.csv"))
```


## Introduction

## Data and Analyses

## Juvenile Hare Initial Investigation

### Annual juvenile hare trap counts
```{r}
# build working dataset
juv_bonanza_hares = bonanza_hares_raw %>% 
  # filter for juveniles
  filter(age == "j") %>% 
  # lubridate date
  mutate(date = mdy(date)) %>% 
  # add yr column
  mutate(year = year(date)) %>% 
  # add full site name column
  mutate(full_site = case_when(
    grid == "bonrip" ~ "Bonanza Riparian",
    grid == "bonbs" ~ "Bonanza Black Spruce",
    grid == "bonmat" ~ "Bonanza Mature"
  ))
```
```{r}
# ggplot w x = year
ggplot(juv_bonanza_hares, aes(x = year)) + 
  # hist w 14 bins
  geom_histogram(binwidth = 1, fill = "Dark Green") + 
  # build x axis labels
  scale_x_continuous(
    name="Year", 
    limits=c(1998, 2013), 
    breaks=c(1999,2001, 2003, 2005, 2007, 2009, 2011)) +
  # add theme
  theme_linedraw() +
  # add labels
  labs(x = "Year", 
       y = "Juvenile Hare Trap Counts", 
       title = "Juvenile Hare Trap Counts by Year") +
  # center title
  theme(plot.title = element_text(hjust = 0.5))
```

Fig 1: Juvenile Hare Trap Counts at Bonanza Creek Experimental Forest for Years 1999 - 2012
```{r}
# summary stats for analyses
juv_trap_counts_summary = juv_bonanza_hares %>% 
  # group by yr
  group_by(year) %>% 
  # count
  summarize(
    count = n()
  )
# mean, median, max, min juvenile traps for 1999 - 2012
mean_traps = mean(juv_trap_counts_summary$count)
median_traps = median(juv_trap_counts_summary$count)
max_traps = max(juv_trap_counts_summary$count)
min_traps = min(juv_trap_counts_summary$count)
```
#### Analyses:

(((add this)))

### Visualize juvenile hare weights

```{r}
# ggplot w x = sex, y = weight
ggplot(juv_bonanza_hares, aes(x = sex, y = weight, color = sex)) +
  # jitter plot
  geom_jitter() + 
  # group by site name
  facet_wrap(~ full_site) +
  # add labels
  labs(x = "Sex", 
       y = "Weight [grams]", 
       title = "Juvenile Hare Weights at Bonanza Trapping Locations") +
  # rename x-axis labels
  scale_x_discrete(labels = c("Female","Male","NA")) + 
  # remove legend
  guides(color = FALSE) +
  # center title
  theme(plot.title = element_text(hjust = 0.5))
```

Fig 2: Juvenile Hare Weights [g] at Three Bonanza Sites Sorted by Site and Sex for Hares Trapped between 1999 and 2012
```{r}
# summary stats for analyses
juv_weights_sex_site = juv_bonanza_hares %>% 
  # group by sex and site
  group_by(sex, full_site) %>% 
  # add mean, sd, sample
  summarise(
    mean_weight = round(mean(weight, na.rm = TRUE),1),
    sd_weight = round(sd(weight, na.rm = TRUE),1),
    sample_size = n()
  ) 
```
#### Analyses:

(((add this)))

### Juvenile weight comparison (male & female snowshoe hares)

```{r}
# summary stats for analyses
juv_weights_sex = juv_bonanza_hares %>% 
  # group by sex and site
  group_by(sex) %>% 
  # add mean, sd, sample
  summarise(
    mean_weight = round(mean(weight, na.rm = TRUE),1),
    sd_weight = round(sd(weight, na.rm = TRUE),1),
    sample_size = n()
  ) 

juv_weights_sex %>%
  # change labels for male, female
  mutate(sex = case_when(
    sex == "f" ~ "Female",
    sex == "m" ~ "Male"
  )) %>% 
  # build table w kbl extra, rename columns
  kbl(caption = "Table 1: Juvenile Hare Weights for Bonanza Sites", col.names = c("Sex", "Mean Weight [g]", "Standard Deviation [g]", "Sample Size")) %>%
  kable_classic(full_width = F, html_font = "Cambria")
```

```{r, include = FALSE}
# plot exploratory histograms and male and female weights to check for high-level normality 
male_weights = juv_bonanza_hares %>% 
  filter(sex == "m")
ggplot(male_weights, aes(x = weight)) + 
  geom_histogram(bins = 10)
female_weights = juv_bonanza_hares %>% 
  filter(sex == "f")
ggplot(female_weights, aes(x = weight)) + 
  geom_histogram(bins = 10)
```


### Relationship between juvenile weight & hind foot length

## Summary

## References

